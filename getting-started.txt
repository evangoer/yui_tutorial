.. _getting-started:

******************************
Getting Started with SimpleYUI
******************************

The easiest way to get started with YUI is to use *SimpleYUI*. The SimpleYUI file is a convenient package of YUI's most fundamental functionality: DOM tasks, event abstraction, UI effects, and AJAX. 

All examples in this tutorial are variations on a minimal but valid HTML5 document. For brevity, we will sometimes only display the relevant JavaScript code. In general, you can assume that any example code you see is running in a document that resembles:

.. literalinclude:: examples/skeleton.html
	:language: html
	:linenos:

In this skeleton document, the first ``<script>`` element does two things:

1. It pulls in the minified, gzipped SimpleYUI file from Yahoo's `CDN <http://en.wikipedia.org/wiki/Content_delivery_network>`_. While you can always download and store a local copy of YUI, using the CDN is faster and more convenient.

2. It instantiates a global YUI object named ``Y`` for immediate use. You can access the entire YUI library through this object. 

.. note:: 
	Wait a second -- a global object? Weren't we just bragging about YUI's fancy sandboxing? It's true. We feel terribly guilty. Later in this tutorial, we'll move beyond SimpleYUI's limitations and explore YUI's more advanced features. But for simple apps and demonstrations, SimpleYUI is just fine.

.. _getting-a-node:

Getting a Node
==============

The ``Y.one()`` method makes it easy to select and manipulate a single element on the page. ``Y.one()`` takes a CSS selector and returns a `Node <http://developer.yahoo.com/yui/3/api/Node.html>`_ object. Once you have a ``Node``, it is easy to change its properties by calling additional methods. 

:download:`Example 1 <examples/dom-highlight-one.html>` uses YUI to dynamically add a class to a ``<div>``, turning it red.

.. literalinclude:: examples/dom-highlight-one.html
	:language: html
	:linenos:
	
Y.one() selects the element with an ``id`` of ``demo`` and creates a ``Node`` object to represent it. We then call the `Node.addClass() <http://developer.yahoo.com/yui/3/api/Node.html#method_addClass>`_ method, which adds the ``.highlight`` class to the element. If we load the document with JavaScript enabled, the ``<div>`` is highlighted red.

Of course, we could have easily highlighted the ``<div>`` with CSS alone. Let's try something a little more interesting.

In :download:`Example 2 <examples/dom-highlight-one-onclick.html>`, the ``<div>`` starts out unstyled. But as soon you click anywhere in the document, the ``<div>`` turns red.

.. literalinclude:: examples/dom-highlight-one-onclick.html
	:linenos:
	:lines: 11-13

This time, we call ``Y.one()`` twice. The first call, ``Y.one("document")``, creates a node representing the entire HTML document. We then attach an event to the document by calling the `on() <http://developer.yahoo.com/yui/3/api/EventTarget.html#method_on>`_ method, which requires at least two arguments:

* A string indicating the event to listen for (such as ``"click"`` or ``"hover"``).
* An event handler function to trigger when the event occurs.

Here, we've specified a click event to trigger for the entire document. If you click anywhere in the document, the event handler function triggers and does exactly what Example 1 did: create a ``Node`` object out of the ``demo`` div and add the ``.highlight`` class.

.. note:: 
    Example 2 uses an anonymous (nameless) function to handle the event. Anonymous functions are common in JavaScript, but if you're coming to this tutorial from another language, this idiom might look unfamiliar. Rewritten with a named function, the code would look like this:

    .. code-block:: javascript
      :linenos:

      var highlightDiv = function(e) {
        Y.one("#demo").addClass("highlight");
      };

      Y.one("document").on("click", highlightDiv);

    However, it's often more convenient to just use an anonymous function for event handlers.

Getting Lots of Nodes
=====================

The ``Y.all()`` method is similar to ``Y.one()``, except that when you give it a CSS selector,  it selects and returns multiple nodes as a `NodeList <http://developer.yahoo.com/yui/3/api/NodeList.html>`_ object. For example, calling ``Y.all("p")`` would return a ``NodeList`` containing all paragraphs in the document.

Conveniently, a number of ``NodeList`` methods are similar to ``Node`` methods. For example, we've already seen ``Node.addClass()`` in action. ``NodeList.addClass()`` does almost the same thing -- it adds a class to every node in the node list.

Let's take a look at how ``Y.all()`` works with CSS selectors in more detail. 

:download:`Example 3 <examples/dom-highlight-all.html>` provides a new HTML page with some interesting structure and CSS classes to select on. The page also includes some links for us to attach events.

.. literalinclude:: examples/dom-highlight-all.html
	:language: html
	:linenos:
	:lines: 1-30

To this page, we add some JavaScript:

.. literalinclude:: examples/dom-highlight-all.html
	:linenos:
	:lines: 33-43

.. _creating-highlight-function:

Creating a highlight() function
-------------------------------

The ``highlight()`` function is an event handler that visually highlights the elements that were selected. Into this function, YUI passes:

* ``e`` -- an object representing event that triggered. We actually saw this parameter back in :ref:`getting-a-node`. Earlier, we just ignored it, but this time, we're going to do something with it.
* ``selector`` -- a CSS selector, such as ``"li.foo"``. This selector represents the elements we want to highlight.

.. literalinclude:: examples/dom-highlight-all.html
	:linenos:
	:lines: 33-37

The first line overrides the browser's default click behavior. Ordinarily, clicking on a link takes you to the link's location. Calling ``preventDefault()`` on the click event prevents this default behavior. To make what we're doing absolutely clear, the ``href`` of each link points to the home pages of some of our favorite JavaScript libraries. Thanks to ``preventDefault()``, the value of the ``href`` is irrelevant; clicking the links does not actually take us off the page. We'll see more useful event methods later on in :ref:`changing-node-properties` and again in :ref:`events`.

The second line gets *all* nodes on the page and then removes the ``highlight`` class from each node, resetting the page to its initial, un-highlighted state. This line is not particularly efficient -- getting all nodes on the page is expensive, and even worse, we have to pay that cost every time we call ``highlight()``. We could be more clever about how we do this refresh, but for demo purposes, this approach is acceptable.

Finally, the third line does the highlighting work. ``Y.all()`` takes the CSS selector we passed in, selects the appropriate nodes and highlights them.

Adding events
-------------

Now, all that's left is to attach some events to the links. Use ``Y.one()`` to grab the anchor node, use ``.on()`` to attach a click event with a ``highlight()`` handler, and... we're done, right? Something like this::

  Y.one("#first").on("click", highlight(e, ".baz"));

Unfortunately, this doesn't work. The problem is that we want to pass an event handler function into ``on()`` to be executed *later*, when the event triggers. But in the above code, ``highlight(e, ".baz")`` executes *now*, and so what we're really doing is::

  Y.one("#first").on("click", returned-value-of-executing-highlight);

Unless ``highlight()`` returns a function (which it doesn't), this will fail. The click event may fire, but we didn't give it a valid handler function to execute, so nothing will happen.

There are two possible solutions:

1. Pass in ``highlight()``, but wrapped in an anonymous function to defer execution:: 

     Y.one("#first").on("click", function(e) {
       highlight(e, ".baz");
     });

   The key difference is this code *declares* an anonymous function, but does not actually *execute* it. YUI now has something valid to call when the event triggers. 

2. Use the extended form of the ``on()`` method. We've seen ``on()`` working with just two parameters, but the full form is::

     on(type, fn, context, args*)
   
   where:

     * ``type`` is the type of the event, such as "click".
     * ``fn`` is the function to call to handle the event.
     * ``context`` is the object where we are attaching the event. By default, the value of this parameter is the ``NodeList`` itself. We actually don't want to mess with this object, so we'll just explicitly set it to the special JavaScript object ``this``, which yields the same behavior. 
     * ``args`` is one or more extra arguments to be passed into the handler function. Aha -- here is where we can supply our ``selector`` argument, or anything else extra that our handler function might need.

   So for our purposes, we could call ``on()`` with four arguments::

     Y.one("#first").on("click", highlight, this, ".baz");

   which again, passes our ``highlight()`` function and the argument it needs on to YUI, to be executed later. 

Either form will work. We'll pick option #2 because it lets us declare our events more compactly::

  Y.one("#first").on("click", highlight, this, ".baz");
  Y.one("#second").on("click", highlight, this, "li.foo");
  Y.one("#third").on("click", highlight, this, ".foo .baz");
  Y.one("#fourth").on("click", highlight, this, ".foo > .baz");
  Y.one("#fifth").on("click", highlight, this, "li strong");

Try clicking on the links in :download:`Example 3 <examples/dom-highlight-all.html>` while viewing the source. Does it highlight the links that you expect?

.. _changing-node-properties:

Changing Node Properties
========================

Once you select a node using ``Y.one()`` or ``Y.all()``, you can do a lot more than just add and remove classes. This section provides a taste of the full `Node API <http://developer.yahoo.com/yui/3/api/Node.html>`_.

Changing Content
----------------

:download:`Example 4 <examples/dom-append.html>` demonstrates appending and replacing content:

.. literalinclude:: examples/dom-append.html
	:language: html
	:linenos:

``Node.append()`` inserts the supplied string or element as the node's last child, while ``Node.setContent()`` replaces all of the node's content with the new string or element. Both methods automatically convert strings of HTML markup (such as ``"<p>Some text</p>"``) to HTML before doing the insert.

Getting and Setting DOM Attributes
----------------------------------

Under the covers, a ``Node`` object is a wrapper for a native DOM node object. If you are familiar with the DOM, you can use ``Node.get()`` and ``Node.set()`` to freely read and write DOM attributes such as ``parentNode`` and ``firstChild``. For example, in::

  var node = Y.one("#foo");
  var parent = node.get("parentNode");

the ``parent`` variable holds ``#foo``'s parent node, as a YUI ``Node`` object.

You can also use ``set`` to change the content of the attribute, by setting the ``innerText`` attribute. In fact, ::

  Y.one("foo").set("innerHTML", "<li>GOODBYE COMRADE</li>");

is equivalent to our earlier ::

  Y.one("#demo").setContent("<li>GOODBYE COMRADE</li>");

.. TODO: is a complete list of attributes documented? It's not just the DOM Node attributes, there are many more, some non-standard...? 

Moving Nodes
------------

You can use ``Node.setXY()`` to move a node to a new absolute location on the page. For example, to move an element 100 pixels to the right and 200 pixels down, as measured from the top left corner of the page::

  Y.one("demo").setXY([100, 200]);

You can use ``setXY()`` along with some properties of the Event object to create some interesting effects with very little code. We've already seen useful methods like :ref:`preventDefault() <creating-highlight-function>`, but the Event object also carries information about the event itself, including ``e.pageX`` and ``e.pageY``. This means you can capture the click's X,Y coordinates anywhere on the page and use them to move a node around, as shown in :download:`Example 5 <examples/dom-follow-my-click.html>`.

.. literalinclude:: examples/dom-follow-my-click.html
	:lines: 17-19

Creating Transitions
--------------------

fade #demo, then remove it from the DOM::

  Y.one('#demo').transition({
    easing: 'ease-out',
    duration: 2, // seconds
    opacity: 0
  }, function() {
    this.remove();
  });